# 2022paspeech
Characterization of how neuronal populations in A1 and non-primary AC regions encode FT, VOT, and combinations of FT and VOT

# Producing databases
The file `studyparams.py` contains the list of animals used in this study as well as
relevant file paths and statistical parameters for the database calculations

## `database_generation.py`
* `database_tone_responsive.py`: Estimate responses to pure tones. It creates `SUBJECT_paspeech_tones_pval.h5` (it takes 3 min)
* `database_freq_tuning.py`: Estimate frequency tuning. It creates `SUBJECT_paspeech_freq_tuning.h5` (it takes 1 min)
* `database_am_responsiveness.py`: Estimate responses to AM sounds. It creates `SUBJECT_paspeech_am_pval.h5` (it takes 2 min)
* `database_am_tuning.py`: Estimate tuning to AM rate. It creates `SUBJECT_paspeech_am_tuning.h5` (it takes 42s)
* `database_speech_responsive.py`: Estimates responsiveness to speech sounds (FT and VOT). It creates `SUBJECT_paspeech_speech_pval.h5` (it takes 3.5 min)
* `database_speech_selective.py`: Estimates selectivity to FT and VOT. It creates `SUBJECT_speech_tuning.h5` (it takes 2 min)

 #For all databases, "BEST" indicates the maximum absolute value difference between the mean firing rate for a given stimulus (e.g. modulation rate) and baseline firing rate for each cell.

## `database_generation_funcs.py`
Contains functions called during database generation.


# Database contents

The initial database is generated by `celldatabase.generate_cell_database_from_subjects()`. It contains columns according to the inforec files (``subject``, ``date``, etc) and the spike sorting results (``cluster``, ``spikeShape``, etc).



## Base stats:
These are additional columns calculated for all cells:

* *fancyStat*: mean firing rate after event x.
* *anotherStat*: max firing rate under y condition.

## Indices:
These are additional columns calculated for a selected set of cells:

* *fancyIndex*: A-B/A+B where A is the response and B is the baseline.

# Generate files
`generate_psycurve_cohortAverages.py` : This generates a population average psychometric stored in `data_cohort_average_psycurves.npz`
`generate_psycurve_exampleMouse.py` :  This generates a psychometric for a single example mouse, stored in `data_example_mice_psycurves.npz`


# Figures

All figures require access to the databases, the clustered ephys data, and the behavior data.

## Figure 1 (Mice can discriminate speech sounds)
Created by `figure_psycurve_exampleMouse.py`.

### Panel A
Psycurve for example mouse performing FT task (using data generated from `generate_psycurve_exampleMouse.py`)
### Panel B
Psycurve for example mouse performing VOT task (using data generated from `generate_psycurve_exampleMouse.py`)
### Panel C
Population averaged Psycurve from the FT cohort (using data generated from `generate_psycurve_cohortAverages.py`)
### Panel D
Population averaged Psycurve from the VOT cohort (using data generated from `generate_psycurve_cohortAverages.py`)
