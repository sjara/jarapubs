#  2025acpop
Population analysis of AC responses.

# Preparing the data
* Copy data from server:
  * `rsync -a --progress --exclude="pc_features.npy" --exclude="template_features.npy" --exclude=".phy" --exclude="rez.mat" jarastore:/data/neuropixels/{feat014,feat015,feat016,feat017,feat018,feat019} /data/neuropixels/`
* Split the data (for each animal): 
  * `python neuropix_split_multisession.py feat014`

# Producing databases
The file `studyparams.py` contains the list of animals used in this study as well as relevant file paths and statistical parameters for the database calculations.

## `database_generation.py`
It takes <1 second.
Output: `celldb_2025acpop_basic.h5`

## `database_generation_coords.py`
You need to run it for each subject. It takes 5-10 seconds for each subject.
Output: `celldb_2025acpop_coords.h5`

## `database_responsiveness.py`
Saves firing rates and p-values in response to natural sounds.

## `generate_average_LFP_per_channel.py`
Reads the raw data and calculates the sound-evoked average LFP for each channel / each stimulus.


# Extras:

## `extras/figure_recording_locations.py`
Creates a figure showing the cell locations across all subjects.

## `extras/report_lfp_and_histology.py`
Creates reports with average LFP for each channel and location of cells in brain slices.


# Database contents

The initial database is generated by `celldatabase.generate_cell_database_from_subjects()`.
It contains columns according to the inforec files (`'subject'`, `'date'`, etc) and the spike sorting results (`'cluster'`, `'spikeShape'`, etc).


## Additional metrics:
These are additional columns calculated for all cells:

* *fancyStat*: mean firing rate after event x.
* *anotherStat*: max firing rate under y condition.


# Figures

All figures require access to the databases, the spike-sorted ephys data, and the behavior data.

## Figure 1 (Write name of this figure here)
Created by `figure_myfirstfig.py`.

### Panel A
Cartoon of a neural circuit created in Inkscape.
### Panel B
Example cell showing strong response, using data generated by `generate_example_firstfig.py`.

